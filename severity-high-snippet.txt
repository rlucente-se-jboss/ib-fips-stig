
# Quick and dirty STIG remediations for severity "high" items by replacing
# the entire file even though only specific lines are incorrect

# Rule: Disable Ctrl-Alt-Del Burst Action
[[customizations.files]]
path = "/etc/systemd/system.conf"
data = """
[Manager]
DefaultLimitCORE=0:infinity
CtrlAltDelBurstAction=none
"""

# Rule: Prevent Login to Accounts With Empty Password
[[customizations.files]]
path = "/etc/pam.d/system-auth"
data = """
#%PAM-1.0
# This file is auto-generated.
# User changes will be destroyed the next time authselect is run.
auth        required      pam_env.so
auth        sufficient    pam_unix.so try_first_pass
auth        required      pam_deny.so

account     required      pam_unix.so

password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
password    sufficient    pam_unix.so try_first_pass use_authtok sha512 shadow
password    required      pam_deny.so

session     optional      pam_keyinit.so revoke
session     required      pam_limits.so
-session     optional      pam_systemd.so
session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid
session     required      pam_unix.so
"""

[[customizations.files]]
path = "/etc/pam.d/password-auth"
data = """
#%PAM-1.0
# This file is auto-generated.
# User changes will be destroyed the next time authselect is run.
auth        required      pam_env.so
auth        sufficient    pam_unix.so try_first_pass
auth        required      pam_deny.so

account     required      pam_unix.so

password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
password    sufficient    pam_unix.so try_first_pass use_authtok sha512 shadow
password    required      pam_deny.so

session     optional      pam_keyinit.so revoke
session     required      pam_limits.so
-session     optional      pam_systemd.so
session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid
session     required      pam_unix.so
"""

# Rule: Disable SSH Access via Empty Passwords
[[customizations.files]]
path = "/etc/ssh/sshd_config.d/00-complianceascode-hardening.conf"
data = "PermitEmptyPasswords no"

